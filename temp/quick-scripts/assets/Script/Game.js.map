{"version":3,"sources":["Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport { user } from './modules/data'\nimport { ballScale, ballDerection, ballPositions, bulletPositions } from \"./modules/data\"\nimport { getPositive, getRandom } from './modules/util';\n\n@ccclass\nexport default class NewClass extends cc.Component {\n\n  @property(cc.Prefab)\n  ballPrefab: cc.Prefab = null;\n\n  @property(cc.Prefab)\n  bulletPrefab: cc.Prefab = null;\n\n  @property(cc.Prefab)\n  coinPrefab: cc.Prefab = null;\n\n  @property(cc.Node)\n  car: cc.Node = null\n\n  @property(cc.Node)\n  ground: cc.Node = null\n\n  @property(cc.Label)\n  score: cc.Label = null\n\n  @property(cc.Label)\n  gold: cc.Label = null\n\n  @property(cc.Label)\n  userName: cc.Label = null\n\n  @property(cc.Node)\n  result: cc.Node = null\n\n  @property\n  balls: any[] = []\n  gameTime: number = 0\n  carY: number = 0\n  stopSpawnBullet: boolean = false\n  stopSpawnBall: boolean = false\n  idCount: number = 0\n  p1: number = 0 // 大球的生成概率\n  p2: number = 0.1 // 中球的生成概率\n  p3: number = 0.9 // 小球的生成概率\n  spawnCount: number = 4 // 自动生成小球倒计时 毫秒\n  scoreNum: number = 0 //得分\n  done: boolean = false //游戏结束鸟\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad() {\n    this.carY = this.car.y + this.car.height / 2;\n    this.car.getComponent('Car').game = this\n    this.spawnNewBall()\n    this.initNewBullet()\n    this.userName.string = user.userInfo.nickName\n  }\n\n  start() {\n\n  }\n\n  spawnNewBall() {\n    if (!this.stopSpawnBall) {\n      this.initNewBall()\n    }\n    this.spawnCount = 4\n  }\n\n  // 生产新的球体\n  initNewBall() {\n    let scale = getRandom([ballScale.BIGBIG, ballScale.BIG, ballScale.NORMAL], [this.p1, this.p2, this.p3])\n    let ballCount = this.balls.length\n    const ball = cc.instantiate(this.ballPrefab)\n    // 获取前二次的hp\n    let lastHP = ballCount <= 2 ? 0 : this.balls[ballCount - 3].HP\n    // 计算本次最大hp\n    let HPMax = user.bullet.power * user.bullet.speed * (1 + 0.5)\n    // 根据时间增长得出一个hp\n    let HPCur = 10 + this.gameTime / 120 * HPMax\n    // 最终hp在前二次于本次之间选择\n    let HP = Math.floor(cc.random0To1() * (HPCur - lastHP) + lastHP) || 1\n    // 随机方向\n    let dRandom = cc.random0To1() > 0.5 ? ballDerection.Left : ballDerection.Right\n    // 记录本次球信息\n    this.balls.push({\n      HP: HP,\n      derection: dRandom\n    })\n    // 计算高度\n    let x: number, y: number\n    if (scale == ballScale.NORMAL) {\n      y = (this.node.height / 2 - this.carY) / 3 + this.carY - ball.height * scale / 2\n    }\n    if (scale == ballScale.BIG) {\n      y = (this.node.height / 2 - this.carY) / 3 * 2 + this.carY - ball.height * scale / 2\n    }\n    if (scale == ballScale.BIGBIG) {\n      y = (this.node.height / 2 - this.carY) + this.carY - ball.height * scale / 2\n    }\n    x = dRandom == ballDerection.Left ? this.node.width / 2 : -this.node.width / 2\n    let Ball = ball.getComponent('Ball')\n    Ball.num = Ball.HP = HP\n    Ball.scale = scale\n    Ball.maxY = y\n    Ball.game = this\n    Ball.derection = dRandom\n    Ball.id = this.idCount;\n    Ball.points.string = HP + ''\n    ballPositions[this.idCount] = {\n      x: 0,\n      y: 0,\n      width: 0,\n      node: null\n    }\n    this.idCount++\n    ball.setPosition(cc.p(x, y))\n    this.node.addChild(ball)\n    // 更改下次产生球的概率\n    this.p3 = getPositive(this.p3 - this.gameTime % 20 * 0.15)\n    if (this.p3 == 0) {\n      this.p1 = getPositive(this.gameTime % 10 * 0.1)\n      this.p2 = getPositive(this.p2 - this.gameTime / 20 * 0.15)\n    } else {\n      this.p1 = getPositive(this.p3 + this.gameTime % 20 * 0.05)\n      this.p2 = getPositive(this.p2 + this.gameTime % 20)\n    }\n  }\n\n  // 分裂球体\n  splitBall(parentBall) {\n    if (parentBall.scale === ballScale.NORMAL) {\n      return;\n    }\n    let scale = parentBall.scale === ballScale.BIG ? ballScale.NORMAL : ballScale.BIG\n    this.initSplitBall({\n      HP: Math.ceil(parentBall.HP * 0.35),\n      derection: ballDerection.Left,\n      x: parentBall.node.x,\n      y: parentBall.node.y,\n      scale: scale\n    })\n    this.initSplitBall({\n      HP: Math.ceil(parentBall.HP * 0.65),\n      derection: ballDerection.Right,\n      x: parentBall.node.x,\n      y: parentBall.node.y,\n      scale: scale\n    })\n  }\n\n  // \n  initSplitBall({ HP, derection, x, scale, y }) {\n    let maxY\n    const ball = cc.instantiate(this.ballPrefab)\n    if (scale == ballScale.NORMAL) {\n      maxY = (this.node.height / 2 - this.carY) / 3 + this.carY - ball.height * scale / 2\n    } else {\n      maxY = (this.node.height / 2 - this.carY) / 3 * 2 + this.carY - ball.height * scale / 2\n    }\n    const Ball = ball.getComponent('Ball')\n    Ball.num = Ball.HP = HP\n    Ball.scale = scale\n    Ball.maxY = maxY\n    Ball.game = this\n    Ball.derection = derection\n    Ball.id = this.idCount\n    ballPositions[this.idCount] = {\n      x: 0,\n      y: 0,\n      width: 0,\n      node: null\n    }\n    this.idCount++\n    ball.setPosition(cc.p(x, y))\n    this.node.addChild(ball)\n  }\n\n  // 生产新的子弹\n  initNewBullet() {\n    const bullet = cc.instantiate(this.bulletPrefab)\n    const Bullet = bullet.getComponent('Bullet')\n    Bullet.game = this\n    Bullet.id = this.idCount\n    bulletPositions[this.idCount] = {\n      x: 0,\n      y: 0,\n      node: null,\n      fade: false\n    }\n    this.idCount++\n    this.node.addChild(bullet)\n  }\n\n  // 检测子弹与球体碰撞\n  onShoot() {\n    for (const i in bulletPositions) {\n      const bullet = bulletPositions[i]\n      if (!bullet.node) {\n        continue;\n      }\n      if (!bullet.fade) {\n        const bulletP = cc.p(bullet.x, bullet.y)\n        for (const j in ballPositions) {\n          const ball = ballPositions[j]\n          if (!ball.node) {\n            continue;\n          }\n          const ballP = cc.p(ball.x, ball.y)\n          const dist = cc.pDistance(bulletP, ballP)\n          if (dist < ball.width / 2) {\n            ball.node.onShooted()\n            bullet.node.onShooted()\n            this.scoreNum++\n            this.score.string = this.scoreNum + ''\n            bullet.fade = true\n          }\n        }\n      }\n    }\n  }\n\n  // 生产金币\n  spawnCoins(x, y) {\n    const coin = cc.instantiate(this.coinPrefab);\n    const Coin = coin.getComponent('Coin')\n    Coin.game = this\n    coin.x = x\n    coin.y = y\n    this.node.addChild(coin)\n  }\n\n  // 获取到金币\n  gainGold() {\n    this.gold.string = parseInt(this.gold.string) + 1 + ''\n  }\n\n  update(dt) {\n    if (this.done) {\n      return;\n    }\n    this.gameTime += dt\n    this.onShoot()\n    this.spawnCount -= dt\n    if (this.spawnCount <= 0) {\n      this.spawnNewBall()\n    }\n  }\n\n  // 一局结束\n  singleGameDone() {\n    for (const i in bulletPositions) {\n      const bullet = bulletPositions[i]\n      bullet.node.over()\n    }\n    for (const i in ballPositions) {\n      const bullet = ballPositions[i]\n      bullet.node.over()\n    }\n    this.stopSpawnBullet = true\n    this.stopSpawnBall = true\n  }\n\n  // 游戏结束\n  gameOver() {\n    this.singleGameDone()\n    this.done = true\n    this.result.active = true\n  }\n\n  // 开始游戏\n  gameStart() {\n    this.done = false\n    this.result.active = false\n    this.stopSpawnBullet = false\n    this.stopSpawnBall = false\n    this.initNewBullet()\n    this.spawnNewBall()\n  }\n}\n"]}